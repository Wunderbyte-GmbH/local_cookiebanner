{"version":3,"file":"init.min.js","sources":["../src/init.js"],"sourcesContent":["/**\n * @module local_cookiebanner/init\n * @copyright 2025\n * @license   https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\n\nexport const init = (hascookie, templatedata, loggedin) => {\n    const link = document.getElementById('cookie-settings-link');\n    if (link) {\n        link.addEventListener('click', (e) => {\n            e.preventDefault();\n\n            require(['local_cookiebanner/banner'], function(banner) {\n                banner.showbanner(templatedata, loggedin);\n            });\n        });\n    }\n    if (localStorage.getItem('cookie_consent_remember') == 'settech' && hascookie) {\n        Ajax.call([{\n            methodname: 'local_cookiebanner_delete_username_cookie',\n            args: {}\n        }])[0].then(() => {\n            // eslint-disable-next-line no-console\n            console.log(\"Moodle username cookie deleted.\");\n            localStorage.setItem('cookie_consent_remember', 'settech');\n            return null;\n        }).catch(error => {\n            // eslint-disable-next-line no-console\n            console.error(\"Failed to set Moodle username cookie:\", error);\n        });\n    }\n    if (localStorage.getItem('cookie_consent_remember') == 'all') {\n        Ajax.call([{\n            methodname: 'local_cookiebanner_set_username_cookie',\n            args: {}\n        }])[0].then(() => {\n            // eslint-disable-next-line no-console\n            console.log(\"Moodle username cookie set.\");\n            localStorage.setItem('cookie_consent_remember', 'setall');\n            return null;\n        }).catch(error => {\n            // eslint-disable-next-line no-console\n            console.error(\"Failed to set Moodle username cookie:\", error);\n        });\n    }\n    if (localStorage.getItem('cookie_consent_remember') == 'tech') {\n        Ajax.call([{\n            methodname: 'local_cookiebanner_delete_username_cookie',\n            args: {}\n        }])[0].then(() => {\n            // eslint-disable-next-line no-console\n            console.log(\"Moodle username cookie deleted.\");\n            localStorage.setItem('cookie_consent_remember', 'settech');\n            return null;\n        }).catch(error => {\n            // eslint-disable-next-line no-console\n            console.error(\"Failed to set Moodle username cookie:\", error);\n        });\n    }\n};\n"],"names":["hascookie","templatedata","loggedin","link","document","getElementById","addEventListener","e","preventDefault","require","banner","showbanner","localStorage","getItem","call","methodname","args","then","console","log","setItem","catch","error"],"mappings":";;;;;oJAQoB,CAACA,UAAWC,aAAcC,kBACpCC,KAAOC,SAASC,eAAe,wBACjCF,MACAA,KAAKG,iBAAiB,SAAUC,IAC5BA,EAAEC,iBAEFC,QAAQ,CAAC,8BAA8B,SAASC,QAC5CA,OAAOC,WAAWV,aAAcC,gBAIW,WAAnDU,aAAaC,QAAQ,4BAA2Cb,yBAC3Dc,KAAK,CAAC,CACPC,WAAY,4CACZC,KAAM,MACN,GAAGC,MAAK,KAERC,QAAQC,IAAI,mCACZP,aAAaQ,QAAQ,0BAA2B,WACzC,QACRC,OAAMC,QAELJ,QAAQI,MAAM,wCAAyCA,UAGR,OAAnDV,aAAaC,QAAQ,0CAChBC,KAAK,CAAC,CACPC,WAAY,yCACZC,KAAM,MACN,GAAGC,MAAK,KAERC,QAAQC,IAAI,+BACZP,aAAaQ,QAAQ,0BAA2B,UACzC,QACRC,OAAMC,QAELJ,QAAQI,MAAM,wCAAyCA,UAGR,QAAnDV,aAAaC,QAAQ,0CAChBC,KAAK,CAAC,CACPC,WAAY,4CACZC,KAAM,MACN,GAAGC,MAAK,KAERC,QAAQC,IAAI,mCACZP,aAAaQ,QAAQ,0BAA2B,WACzC,QACRC,OAAMC,QAELJ,QAAQI,MAAM,wCAAyCA"}